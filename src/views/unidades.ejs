<section class="card">
  <h1>Unidades</h1>

  <form method="get" class="filters">
    <label>
      <span>Cede</span>
      <select name="cedis_id" onchange="this.form.submit()">
        <option value="">— Todas —</option>
        <% (cedis || []).forEach(c => { %>
          <option value="<%= c.id %>" <%= String(cedisId||'')===String(c.id) ? 'selected' : '' %>><%= c.nombre %></option>
        <% }) %>
      </select>
    </label>
  </form>

  <table class="table">
    <thead>
      <tr><th>Placa</th><th>Cede</th><th>Tipo</th><th>Km</th><th>Estado</th><th>Acciones</th></tr>
    </thead>
    <tbody>
      <% (unidades || []).forEach(u => { %>
        <tr>
          <td><a href="/historial/<%= u.placa %>"><%= u.placa %></a></td>
          <td><%= u.cedis_nombre || '-' %></td>
          <td><%= u.tipo || '-' %></td>
          <td><%= u.kilometraje || 0 %></td>
          <td><%= u.estado || 'ACTIVA' %></td>
          <td>
            <form method="post" action="/unidades/<%= u.id %>/programar" style="display:inline">
              <button class="btn primary" type="submit">Programar por IA</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</section>
