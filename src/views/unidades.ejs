<h2>Unidades</h2>

<form method="get" action="/unidades" class="filters">
  <label>CEDIS:
    <select name="cedis_id">
      <option value="">(Todos)</option>
      <% cedisLista.forEach(c => { %>
        <option value="<%= c.id %>" <%= (filtroActual.cedisId == c.id ? 'selected' : '') %>><%= c.nombre %></option>
      <% }) %>
    </select>
  </label>
  <button type="submit">Filtrar</button>
</form>

<table>
  <thead><tr><th>Placa</th><th>Tipo</th><th>CEDIS</th><th>Estado</th><th>Próximo sugerido</th><th>Acción</th></tr></thead>
  <tbody>
  <% if (!unidades || !unidades.length) { %>
    <tr><td colspan="6">Sin unidades</td></tr>
  <% } else { unidades.forEach(u => { %>
    <tr>
      <td><%= u.placa %></td>
      <td><%= u.tipo %></td>
      <td><%= u.cedis_nombre || 'N/D' %></td>
      <td><%= u.estado %></td>
      <td><%= proximos[u.id] || '—' %></td>
      <td>
        <form method="post" action="/unidades/<%= u.id %>/programar" style="display:inline">
          <button>Programar</button>
        </form>
      </td>
    </tr>
  <% }) } %>
  </tbody>
</table>

<hr/>
<h3>Crear unidad</h3>
<form method="post" action="/unidades">
  <label>Placa <input name="placa" required></label>
  <label>Tipo <input name="tipo" placeholder="CAMION/HINO/GRANEL"></label>
  <label>CEDIS <input name="cedis_nombre" placeholder="Cartago, Guapiles, ..."></label>
  <button>Crear</button>
</form>
